<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
 
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <title>Leaflet Maps</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" />
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:ital,wght@0,200;0,400;0,700;1,400&display=swap"
        rel="stylesheet">
        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
        integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
        crossorigin="" />
    <link rel="stylesheet" href="./style.css">
    
</head>

<body>
  <main> 
        <div   class="gisdatalist">
            <div class="heading">
                <h2>Flood Data</h2>
            </div>
               <div id="Start"> <form action="/action_page.php">
                    <label for="start-date">Flood Start date:</label>
                    <input type="date" id="startdate" name="birthday">
                    
                  </form></div>
                <div id="End">   <form action="/action_page.php">
                    <label for="end-date">Flood End date:</label>
                    <input type="date" id="enddate" name="birthday">
                    
                  </form>
                  </div>
              
                  <div class="dropdown" id="Countrydrop">
                  <form action="/action_page.php">
                    <label for="cars">Choose Country Name:</label>
                    
                    <select id="countries" name="countries">
                      <option value="india">India</option>
                      <option value="indonesia">Indonesia</option>
                      <option value="japan">Japan</option>
                      <option value="laos">Laos</option>
                      <option value="thailand">Thailand</option>
                    </select>
                </form>   
                   
                </div>
                <div id="satellites"> 
                    
            <form action="/action_page.php">
                <label>Choose satellites:</label>
                <input type="checkbox" id="sat1" name="sat1" value="Planet">
                <label for="vehicle1">Planet</label>  
                <input type="checkbox" id="sat2" name="sat2" value="DigitalGlobe">
                <label for="vehicle2">Digital Globe</label><br>
                <input type="checkbox" id="sat3" name="sat3" value="Sentinal-I">
                <label for="vehicle3">Sentinal-I</label>  
                <input type="checkbox" id="sat4" name="sat4" value="Sentinal-II">
                <label for="vehicle3">Sentinal-II</label> 
              </form>
            </div>
            <div id="submitbutton"> 
             <button type="button" onclick="getVal();"  class="btn btn-primary">
                <font color="white"> Submit</font>
    </button></div>
   <div id="daterange">  <h4 id="some">Flood Range</h4></div>
   <div id="datalist">
    <div  >
        <button  name="load_data" id="load_data" > </button>
    </div>
    <br />
    <div id="employee_table"   >
    </div>
       
      
   </div>
        </div>
    <div id="map"></div></main>
 
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
    integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
    crossorigin=""></script>
    <script src="./app.js"></script>
     
</body>

</html>
<script> var footprint;
var coordinatesarray;
var cell_data;
var country;
var employee_data;
 
fetch("https://agile-hollows-34401.herokuapp.com/flooddata").then((response) =>{
    console.log(response);
  })
// var filenames=[], foldernames=[];

// $.get("file:///Users/mayank patidar/Desktop/webmapproject/japan",function(response){
//     document.write(response);
//     getNames();
// });

// function getNames()
// {
//     var files = document.querySelectorAll("a.icon.file");
//     var folders = document.querySelectorAll("a.icon.dir");
//     files.forEach(function(item){filenames.push(item.textContent)})
//     folders.forEach(function(item){foldernames.push(item.textContent.slice(0,-1))})
//     console.log(filenames);
//     console.log(foldernames);
// }
function getVal(){
 
 var x = document.getElementById("startdate").value
    var y = document.getElementById("enddate").value
    country= document.getElementById("countries").value;
    
    document.getElementById("some").innerHTML="Flooddata From "+x +" to "+y;
    document.getElementById("load_data").innerHTML="Load Data";
    document.getElementById("data2").innerHTML="employee1.csv";
    document.getElementById("data3").innerHTML="employee2.csv";
    document.getElementById("data4").innerHTML="employee3.csv";
}


    $(document).ready(function(){
   $('#load_data').click(function(){ alert(country);
    $.ajax({
     url:"employee.csv",
     dataType:"text",
     crossOrigin: true,
              type: 'GET',
              xhrFields: { withCredentials: true },
     success:function(data)
     {
      employee_data = data.split(/\r?\n|\r/);
      var table_data = '<table class="table table-bordered table-striped">';
      for(var count = 0; count<employee_data.length; count++)
      {     
              //you will get acctual output in array
        
            cell_data = employee_data[count].split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);
            
       table_data += '<tr id="roweve"  onclick="rowclick(this)">';
       for(var cell_count=0; cell_count<cell_data.length; cell_count++)
       {
        if(count === 0)
        {
         table_data += '<th>'+cell_data[cell_count]+'</th>';
           
        }
        else
        {
         table_data += '<td>'+cell_data[cell_count]+'</td>';
        }
       }
       table_data += '</tr>';
      }
      table_data += '</table>';
      $('#employee_table').html(table_data);
     }
    });
   });
   
  });
function rowclick(rowno){
 let msg=rowno.cells[5].innerHTML;
 
 var WithOutBrackets=msg.replace(/[\[\]']+/g,'');
 var me=WithOutBrackets.replace(/"/g,"");
         
//   var obj=  JSON.parse( WithOutBrackets   );
 //alert(typeof(me));
 //we have to do string to integer and understand about how array convert into chunk array

  var  coordinates=  me.split(',');
  console.log( coordinates);
const chunk =  coordinates => {
   const size = 2;
   const chunkedArray = [];
   for (let i = 0; i <  coordinates.length; i++) {
      const last = chunkedArray[chunkedArray.length - 1];
      if(!last || last.length === size){
         chunkedArray.push([ coordinates[i]]);
      }else{
         last.push( coordinates[i]);
      }
   };
   return chunkedArray;
};
 
       alert(chunk( coordinates));
    var states = [{
    "type": "Feature",
    "properties": {},
    "geometry": {
        "type": "Polygon",
        "coordinates":[[["129.86889616213875", "31.85092400331079"], ["130.13226059277255", "31.804015706859424"], ["130.11415527263486", "31.731335321675704"], ["129.85082873777677", "31.77787200251359"], ["129.86889616213875", "31.85092400331079"]]]
       }

}];
 states[0]["geometry"]["coordinates"]=[chunk( coordinates)];
console.log(states);
L.geoJSON(states, {
    style: function(feature) {
        switch (feature.properties.party) {
            case 'Republican': return {color: "#ff0000"};
            case 'Democrat':   return {color: "#0000ff"};
        }
    }
}).addTo(map);

}
   </script>